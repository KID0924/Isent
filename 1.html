<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 éƒµè¼ªè¡Œç¨‹äº’å‹•å„€è¡¨æ¿</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Cool & Calm Blues -->
    <!-- Application Structure Plan: The SPA is designed as an interactive dashboard. This structure was chosen over a linear report because the primary user task is comparison and decision-making. The layout features: 1) A persistent filter panel on the left for users to specify their criteria (date, duration, destination, price). 2) A dynamic main content area on the right displaying results as sortable 'cards' for quick scanning and interactive charts for visual comparison. 3) A modal window for viewing detailed information on demand. This non-linear, user-driven approach empowers users to explore the data according to their personal priorities, making the process of finding the ideal cruise faster and more intuitive. -->
    <!-- Visualization & Content Choices: 
        - Report Info: All 6 cruise packages. Goal: Inform/Compare. Method: HTML/Tailwind Cards. Interaction: Dynamically rendered based on filters, with a "Details" button. Justification: Cards provide a scannable summary of key info (price, duration, destination). Library: Vanilla JS.
        - Report Info: Per-person price for each cruise. Goal: Compare. Method: Chart.js Bar Chart. Interaction: Updates dynamically with filters; tooltips show exact prices. Justification: A bar chart is the clearest method for direct quantitative comparison across categories. Library: Chart.js.
        - Report Info: Duration, Per-person price, Number of destinations. Goal: Relationships. Method: Chart.js Bubble Chart. Interaction: Updates with filters; bubble size represents the number of stops. Justification: Bubble chart effectively visualizes the relationship between three different variables, revealing value insights. Library: Chart.js.
        - Report Info: Full details of each cruise. Goal: Inform. Method: HTML/Tailwind Modal. Interaction: Appears on "Details" button click, populated with specific cruise data. Justification: Provides comprehensive information without cluttering the main interface or requiring page navigation. Library: Vanilla JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f1f5f9;
        }
        .chart-container {
            position: relative;
            width: 100%;
            height: 350px;
            max-height: 400px;
        }
        .modal {
            transition: opacity 0.25s ease;
        }
        .modal-content {
            transition: transform 0.25s ease;
        }
        .filter-btn-active {
            background-color: #2563eb !important;
            color: white !important;
            border-color: #2563eb !important;
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
    </style>
</head>
<body class="text-slate-800">

    <div id="app" class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">2025 éƒµè¼ªè¡Œç¨‹äº’å‹•å„€è¡¨æ¿</h1>
            <p class="mt-2 text-slate-600 text-lg">ä½¿ç”¨ç¯©é¸å™¨èˆ‡åœ–è¡¨ï¼Œè¼•é¬†æ‰¾åˆ°æœ€é©åˆæ‚¨çš„å¤¢å¹»èˆªç¨‹ã€‚</p>
        </header>

        <div class="flex flex-col md:flex-row gap-8">

            <aside class="md:w-1/4 lg:w-1/5">
                <div class="bg-white p-6 rounded-xl shadow-lg sticky top-8">
                    <h2 class="text-xl font-bold mb-4 text-slate-900">ç¯©é¸æ‚¨çš„èˆªç¨‹</h2>
                    
                    <div class="mb-6">
                        <h3 class="font-semibold mb-2">æ—…éŠæœˆä»½</h3>
                        <div id="month-filters" class="flex flex-wrap gap-2">
                            <button data-month="6" class="filter-btn text-sm border border-slate-300 bg-white text-slate-700 rounded-full px-4 py-1.5 transition hover:bg-slate-100">å…­æœˆ</button>
                            <button data-month="7" class="filter-btn text-sm border border-slate-300 bg-white text-slate-700 rounded-full px-4 py-1.5 transition hover:bg-slate-100">ä¸ƒæœˆ</button>
                            <button data-month="11" class="filter-btn text-sm border border-slate-300 bg-white text-slate-700 rounded-full px-4 py-1.5 transition hover:bg-slate-100">åä¸€æœˆ</button>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h3 class="font-semibold mb-2">æ—…éŠå¤©æ•¸</h3>
                        <div id="duration-filters" class="flex flex-wrap gap-2">
                            <button data-duration="3" class="filter-btn text-sm border border-slate-300 bg-white text-slate-700 rounded-full px-3 py-1.5 transition hover:bg-slate-100">3å¤©</button>
                            <button data-duration="4" class="filter-btn text-sm border border-slate-300 bg-white text-slate-700 rounded-full px-3 py-1.5 transition hover:bg-slate-100">4å¤©</button>
                            <button data-duration="5" class="filter-btn text-sm border border-slate-300 bg-white text-slate-700 rounded-full px-3 py-1.5 transition hover:bg-slate-100">5å¤©</button>
                            <button data-duration="6" class="filter-btn text-sm border border-slate-300 bg-white text-slate-700 rounded-full px-3 py-1.5 transition hover:bg-slate-100">6å¤©</button>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label for="sort-by" class="font-semibold mb-2 block">æ’åºæ–¹å¼</label>
                        <select id="sort-by" class="w-full p-2 border border-slate-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="default">é è¨­</option>
                            <option value="price_asc">äººå‡åƒ¹æ ¼ (ä½è‡³é«˜)</option>
                            <option value="price_desc">äººå‡åƒ¹æ ¼ (é«˜è‡³ä½)</option>
                            <option value="duration_asc">æ—…éŠå¤©æ•¸ (çŸ­è‡³é•·)</option>
                        </select>
                    </div>

                    <button id="reset-filters" class="w-full bg-slate-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-slate-700 transition">
                        æ¸…é™¤æ‰€æœ‰ç¯©é¸
                    </button>
                </div>
            </aside>

            <main class="md:w-3/4 lg:w-4/5">
                <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
                     <h2 class="text-xl font-bold mb-4 text-slate-900">èˆªç¨‹æ¯”è¼ƒåœ–è¡¨</h2>
                     <p class="text-slate-600 mb-6">æ­¤è™•çš„åœ–è¡¨æœƒæ ¹æ“šæ‚¨çš„ç¯©é¸æ¢ä»¶å‹•æ…‹æ›´æ–°ï¼Œæä¾›è¦–è¦ºåŒ–çš„æ¯”è¼ƒã€‚æ‚¨å¯ä»¥å°‡æ»‘é¼ æ‡¸åœåœ¨åœ–è¡¨ä¸Šä»¥æŸ¥çœ‹è©³ç´°æ•¸å€¼ï¼Œå¹«åŠ©æ‚¨å¿«é€Ÿè©•ä¼°ä¸åŒèˆªç¨‹çš„æ€§åƒ¹æ¯”èˆ‡ç‰¹è‰²ã€‚</p>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-lg font-semibold text-center mb-2">å„èˆªç¨‹äººå‡åƒ¹æ ¼æ¯”è¼ƒ (TWD)</h3>
                            <div class="chart-container mx-auto max-w-xl">
                                <canvas id="price-chart"></canvas>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-center mb-2">å¤©æ•¸ vs åƒ¹æ ¼ vs åœé é»</h3>
                            <div class="chart-container mx-auto max-w-xl">
                                <canvas id="bubble-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h2 id="results-title" class="text-xl font-bold mb-4 text-slate-900">æ‰€æœ‰èˆªç¨‹</h2>
                    <div id="results-grid" class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                    </div>
                    <p id="no-results" class="text-center text-slate-500 py-10 hidden">æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„èˆªç¨‹ï¼Œè«‹å˜—è©¦èª¿æ•´ç¯©é¸å™¨ã€‚</p>
                </div>
            </main>
        </div>
    </div>

    <div id="modal" class="modal fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 opacity-0 pointer-events-none">
        <div id="modal-content" class="modal-content bg-white w-full max-w-3xl max-h-[90vh] rounded-2xl shadow-2xl overflow-hidden flex flex-col transform scale-95">
            <header class="flex justify-between items-center p-4 border-b border-slate-200 flex-shrink-0">
                <h2 id="modal-title" class="text-xl font-bold text-slate-900"></h2>
                <button id="close-modal" class="text-slate-500 hover:text-slate-800 text-2xl">&times;</button>
            </header>
            <div id="modal-body" class="p-6 overflow-y-auto">
            </div>
            <footer class="p-4 bg-slate-50 border-t border-slate-200 flex-shrink-0">
                 <a id="modal-link" href="#" target="_blank" class="block w-full text-center bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition">å‰å¾€é è¨‚é é¢</a>
            </footer>
        </div>
    </div>

    <script>
        const cruiseData = [
            { id: 1, name: 'MSC Bellissima çŸ³å£å³¶ãƒ»é‚£éœ¸', date: '2025/06/24', month: 6, duration: 5, cabin: 'é™½å°æˆ¿â€“å››äººæˆ¿', price: 95600, deposit: 49800, perPerson: 23900, destinations: ['çŸ³å£å³¶', 'é‚£éœ¸'], ship: 'MSC Bellissima', link: 'https://asiayo.com/zh-tw/activity/75576/', highlights: { original: ['çŸ³å£å³¶é»‘ç³–DIYï¼‹æ²™ç˜æµ®æ½›', 'é‚£éœ¸å¤é…’èˆ‡è•éº¥éºµå“å˜—', 'Sea Day SPAé«”é©—æˆ–ç”²æ¿æ´¾å°'], trend: ['Sea Day æ•¸ä½æ–·æ¨é›¢éœå¿ƒèª²ç¨‹', 'æ²‰æµ¸å¼ VR æµ·æ´‹ç”Ÿæ…‹è¬›åº§'] }, itinerary: [ 'Day 1: åŸºéš†æ¸¯å•Ÿèˆª', 'Day 2: çŸ³å£å³¶åœé ', 'Day 3: é‚£éœ¸åœé ', 'Day 4: å…¨å¤©æµ·ä¸Šå·¡èˆª', 'Day 5: æŠµé”åŸºéš†æ¸¯' ], meals: [ 'Day 1: æ™šé¤', 'Day 2-4: æ—©/åˆ/æ™šé¤', 'Day 5: æ—©é¤'] },
            { id: 2, name: 'éº—æ˜Ÿéƒµè¼ª Explor Star ç†Šæœ¬ãƒ»é¹¿å…’å³¶ãƒ»é‚£éœ¸', date: '2025/07/13', month: 7, duration: 6, cabin: 'BSS éœ²å°å®¢æˆ¿â€“å››äººæˆ¿', price: 133600, deposit: 66800, perPerson: 33400, destinations: ['é¹¿å…’å³¶', 'ç†Šæœ¬', 'é‚£éœ¸'], ship: 'éº—æ˜Ÿéƒµè¼ª Explor Star', link: 'https://asiayo.com/zh-tw/activity/51219/', highlights: { original: ['é¹¿å…’å³¶ç ‚æµ´æº«æ³‰ï¼‹ç”œå“é«”é©—', 'ç†Šæœ¬åŸå¤œé–“æŠ•å½±ç‡ˆå…‰ç§€', 'é‚£éœ¸ç‰çƒæœæ‹ç…§æ´»å‹•'], trend: ['æ·±å¤œæ¸¯å£éå¤œæ–‡åŒ–è¡Œ', 'èˆ¹ä¸Šåœ‹éš›ä¸»é¡Œæ™šå®´'] }, itinerary: [ 'Day 1: åŸºéš†æ¸¯å•Ÿèˆª', 'Day 2: å…¨å¤©æµ·ä¸Šå·¡èˆª', 'Day 3: é¹¿å…’å³¶åœé ', 'Day 4: ç†Šæœ¬åœé ', 'Day 5: é‚£éœ¸åœé ', 'Day 6: æŠµé”åŸºéš†æ¸¯' ], meals: ['Day 1: æ™šé¤', 'Day 2-5: æ—©/åˆ/æ™šé¤', 'Day 6: æ—©é¤'] },
            { id: 3, name: 'æ˜Ÿå¤¢éƒµè¼ª Genting Dream æ–°åŠ å¡ãƒ»é¦¬ä¾†è¥¿äº', date: '2025/07/19', month: 7, duration: 4, cabin: 'éœ²å°å®¢æˆ¿ï¼ˆBSSï¼‰â€“å››äººæˆ¿', price: 145600, deposit: 72800, perPerson: 36400, destinations: ['å‰éš†å¡/é¦¬å…­ç”²'], ship: 'æ˜Ÿå¤¢éƒµè¼ª Genting Dream', link: 'https://asiayo.com/zh-tw/activity/52675/', highlights: { original: ['æ–°åŠ å¡æ¿±æµ·ç£é‡‘æ²™å¤œæ™¯', 'é¦¬å…­ç”²å¨˜æƒ¹ç³•èˆ‡æ²³ç•”éŠèˆ¹', 'èˆ¹ä¸Šé­”è¡“èˆ‡æ°´å¹•é›»å½±ç§€'], trend: ['Sea Day æ•¸ä½æ–·æ¨é›¢éœå¿ƒèª²ç¨‹', 'å°åœ˜æ·±åº¦æ–‡åŒ–å°è¦½'] }, itinerary: [ 'Day 1: å°åŒ—âœˆæ–°åŠ å¡, ç™»èˆ¹å•Ÿèˆª', 'Day 2: å‰éš†å¡/é¦¬å…­ç”²åœé ', 'Day 3: å…¨å¤©æµ·ä¸Šå·¡èˆª', 'Day 4: æŠµé”æ–°åŠ å¡, âœˆè¿”å°' ], meals: ['Day 1-4: æ—©/åˆ/æ™šé¤'] },
            { id: 4, name: 'éº—æ˜Ÿéƒµè¼ª Explor Star å…¬æµ·æ­¡æ¨‚éŠ', date: '2025/07/25', month: 7, duration: 3, cabin: 'DPS çš‡å®®å¥—æˆ¿â€“å››äººæˆ¿', price: 78400, deposit: 39200, perPerson: 19600, destinations: ['å…¬æµ·'], ship: 'éº—æ˜Ÿéƒµè¼ª Explor Star', link: 'https://asiayo.com/zh-tw/activity/54113/', highlights: { original: ['ç”²æ¿æ—¥è½ç‰¹è‰²é›å°¾é…’', 'SPAæ¡‘æ‹¿èˆ‡æŒ‰æ‘©å„ªæƒ ', 'ä¸»é¡Œæ´¾å°ï¼ˆæµ·ç›œ/å¤å¨å¤·ï¼‰'], trend: ['æ²‰æµ¸å¼ VR æ¢éšªèª²ç¨‹', 'èˆ¹æ©‹ç‘œä¼½æ™¨é–“æ´»å‹•'] }, itinerary: [ 'Day 1: åŸºéš†æ¸¯å•Ÿèˆª', 'Day 2: å…¨å¤©æµ·ä¸Šå·¡èˆª', 'Day 3: æŠµé”åŸºéš†æ¸¯' ], meals: ['Day 1: æ™šé¤', 'Day 2: æ—©/åˆ/æ™šé¤', 'Day 3: æ—©é¤'] },
            { id: 5, name: 'MSC Bellissima å®®å¤å³¶ãƒ»æ²–ç¹©ãƒ»çŸ³å£å³¶', date: '2025/11/21', month: 11, duration: 5, cabin: 'é™½å°è‰™â€“å››äººæˆ¿', price: 77600, deposit: 43800, perPerson: 19400, destinations: ['å®®å¤å³¶', 'é‚£éœ¸', 'çŸ³å£å³¶'], ship: 'MSC Bellissima', link: 'https://asiayo.com/zh-tw/activity/45842/', highlights: { original: ['å·å¹³ç£ç»ç’ƒèˆ¹', 'ç‰çƒèˆè¹ˆå·¥ä½œåŠ', 'æµ·ä¸Šç’°ä¿è¬›åº§'], trend: ['æ²‰æµ¸å¼æµ·æ´‹ç”Ÿæ…‹ VR', 'Coolcation ç¾é£Ÿå·¡ç¦®'] }, itinerary: [ 'Day 1: åŸºéš†æ¸¯å•Ÿèˆª', 'Day 2: å®®å¤å³¶åœé ', 'Day 3: é‚£éœ¸åœé ', 'Day 4: çŸ³å£å³¶åœé ', 'Day 5: æŠµé”åŸºéš†æ¸¯' ], meals: ['Day 1: æ™šé¤', 'Day 2-4: æ—©/åˆ/æ™šé¤', 'Day 5: æ—©é¤'] },
            { id: 6, name: 'æ­Œè©©é”éƒµè¼ª èå€«å¨œè™Ÿï½æ²–ç¹©', date: '2025/07/20', month: 7, duration: 4, cabin: 'é™½å°è‰™â€“äºŒäººæˆ¿Ã—2', price: 111600, deposit: 60000, perPerson: 27900, destinations: ['é‚£éœ¸'], ship: 'æ­Œè©©é”éƒµè¼ª èå€«å¨œè™Ÿ', link: 'https://asiayo.com/zh-tw/activity/54976', highlights: { original: ['æ²–ç¹©æµ·è‘¡è„å“å˜—é«”é©—', 'é¦–é‡ŒåŸæ–‡åŒ–å·¡ç¦®', 'ç”²æ¿æ˜Ÿç©ºç‘œä¼½', 'Beniimoå¡”ç”œå“DIY'], trend: ['æ²‰æµ¸å¼ VR æ²–ç¹©é¢¨æƒ…å°è¦½', 'èˆ¹ä¸Šä¸»é¡Œç›´æ’­äº’å‹•'] }, itinerary: [ 'Day 1: åŸºéš†æ¸¯å ±åˆ°å•Ÿèˆª', 'Day 2: æŠµé”é‚£éœ¸ãƒ»åœæ³Šéå¤œ', 'Day 3: å•Ÿèˆªé›¢é–‹é‚£éœ¸', 'Day 4: æŠµé”åŸºéš†æ¸¯' ], meals: ['Day 1: åˆ/æ™šé¤', 'Day 2-3: æ—©/åˆ/æ™šé¤', 'Day 4: æ—©é¤'] }
        ];

        const state = {
            filters: {
                month: null,
                duration: null,
            },
            sortBy: 'default'
        };

        const priceChartCtx = document.getElementById('price-chart').getContext('2d');
        const bubbleChartCtx = document.getElementById('bubble-chart').getContext('2d');
        let priceChart, bubbleChart;
        
        const formatCurrency = (value) => new Intl.NumberFormat('zh-TW').format(value);

        function renderPriceChart(data) {
            if (priceChart) {
                priceChart.destroy();
            }
            priceChart = new Chart(priceChartCtx, {
                type: 'bar',
                data: {
                    labels: data.map(c => c.name.split(' ')[0]),
                    datasets: [{
                        label: 'äººå‡åƒ¹æ ¼ (TWD)',
                        data: data.map(c => c.perPerson),
                        backgroundColor: 'rgba(59, 130, 246, 0.7)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1,
                        borderRadius: 5,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (context) => `äººå‡: ${formatCurrency(context.raw)} TWD`
                            }
                        }
                    },
                    scales: {
                        y: { beginAtZero: true, ticks: { callback: (value) => formatCurrency(value) } }
                    }
                }
            });
        }

        function renderBubbleChart(data) {
            if (bubbleChart) {
                bubbleChart.destroy();
            }
            bubbleChart = new Chart(bubbleChartCtx, {
                type: 'bubble',
                data: {
                    datasets: data.map(c => ({
                        label: c.name,
                        data: [{
                            x: c.duration,
                            y: c.perPerson,
                            r: c.destinations.length * 5 + 5
                        }],
                        backgroundColor: `rgba(${Math.floor(Math.random()*100 + 50)}, ${Math.floor(Math.random()*100 + 100)}, 246, 0.7)`,
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (context) => {
                                    const cruise = cruiseData.find(c => c.name === context.dataset.label);
                                    return [
                                        `${cruise.name}`,
                                        `å¤©æ•¸: ${cruise.duration}å¤©`,
                                        `äººå‡åƒ¹æ ¼: ${formatCurrency(cruise.perPerson)} TWD`,
                                        `åœé é»: ${cruise.destinations.length}å€‹`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: { title: { display: true, text: 'æ—…éŠå¤©æ•¸ (å¤©)' } },
                        y: { title: { display: true, text: 'äººå‡åƒ¹æ ¼ (TWD)' }, ticks: { callback: (value) => formatCurrency(value) } }
                    }
                }
            });
        }

        function createCard(cruise) {
            return `
                <div class="bg-white rounded-xl shadow-md overflow-hidden transition hover:shadow-xl hover:-translate-y-1 flex flex-col">
                    <div class="p-6 flex-grow">
                        <p class="text-sm text-slate-500">${cruise.ship}</p>
                        <h3 class="font-bold text-lg text-slate-900 mt-1 mb-2 h-14">${cruise.name}</h3>
                        <div class="flex items-baseline text-slate-800 mb-4">
                            <span class="text-3xl font-bold text-blue-600">${formatCurrency(cruise.perPerson)}</span>
                            <span class="ml-1">TWD / äºº</span>
                        </div>
                        <div class="text-sm text-slate-600 space-y-2">
                            <p>ğŸ—“ï¸ <span class="font-medium">æ—¥æœŸ:</span> ${cruise.date}</p>
                            <p>â³ <span class="font-medium">å¤©æ•¸:</span> ${cruise.duration} å¤©</p>
                            <p>ğŸ“ <span class="font-medium">åœ°é»:</span> ${cruise.destinations.join('ã€')}</p>
                        </div>
                    </div>
                    <div class="p-4 bg-slate-50">
                        <button class="details-btn w-full bg-blue-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-600 transition" data-id="${cruise.id}">
                            æŸ¥çœ‹è©³æƒ…
                        </button>
                    </div>
                </div>
            `;
        }
        
        function renderCards(data) {
            const grid = document.getElementById('results-grid');
            const noResults = document.getElementById('no-results');
            const resultsTitle = document.getElementById('results-title');

            grid.innerHTML = '';
            if (data.length > 0) {
                data.forEach(cruise => {
                    const card = createCard(cruise);
                    grid.insertAdjacentHTML('beforeend', card);
                });
                noResults.classList.add('hidden');
                resultsTitle.textContent = `æ‰¾åˆ° ${data.length} å€‹ç¬¦åˆæ¢ä»¶çš„èˆªç¨‹`;
            } else {
                noResults.classList.remove('hidden');
                resultsTitle.textContent = `ç¬¦åˆæ¢ä»¶çš„èˆªç¨‹`;
            }
        }
        
        function applyFiltersAndSort() {
            let filteredData = [...cruiseData];
            
            if (state.filters.month) {
                filteredData = filteredData.filter(c => c.month === state.filters.month);
            }
            if (state.filters.duration) {
                filteredData = filteredData.filter(c => c.duration === state.filters.duration);
            }
            
            switch(state.sortBy) {
                case 'price_asc':
                    filteredData.sort((a, b) => a.perPerson - b.perPerson);
                    break;
                case 'price_desc':
                    filteredData.sort((a, b) => b.perPerson - a.perPerson);
                    break;
                case 'duration_asc':
                    filteredData.sort((a, b) => a.duration - b.duration);
                    break;
            }

            renderCards(filteredData);
            renderPriceChart(filteredData);
            renderBubbleChart(filteredData);
        }

        function setupEventListeners() {
            document.getElementById('month-filters').addEventListener('click', e => {
                if (e.target.tagName === 'BUTTON') {
                    const month = parseInt(e.target.dataset.month);
                    state.filters.month = state.filters.month === month ? null : month;
                    document.querySelectorAll('#month-filters .filter-btn').forEach(btn => btn.classList.remove('filter-btn-active'));
                    if (state.filters.month) e.target.classList.add('filter-btn-active');
                    applyFiltersAndSort();
                }
            });
            
            document.getElementById('duration-filters').addEventListener('click', e => {
                if (e.target.tagName === 'BUTTON') {
                    const duration = parseInt(e.target.dataset.duration);
                    state.filters.duration = state.filters.duration === duration ? null : duration;
                    document.querySelectorAll('#duration-filters .filter-btn').forEach(btn => btn.classList.remove('filter-btn-active'));
                    if (state.filters.duration) e.target.classList.add('filter-btn-active');
                    applyFiltersAndSort();
                }
            });

            document.getElementById('sort-by').addEventListener('change', e => {
                state.sortBy = e.target.value;
                applyFiltersAndSort();
            });

            document.getElementById('reset-filters').addEventListener('click', () => {
                state.filters.month = null;
                state.filters.duration = null;
                state.sortBy = 'default';
                document.getElementById('sort-by').value = 'default';
                document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('filter-btn-active'));
                applyFiltersAndSort();
            });

            document.getElementById('results-grid').addEventListener('click', e => {
                if (e.target.classList.contains('details-btn')) {
                    const id = parseInt(e.target.dataset.id);
                    openModal(id);
                }
            });

            document.getElementById('close-modal').addEventListener('click', closeModal);
            document.getElementById('modal').addEventListener('click', e => {
                if (e.target.id === 'modal') closeModal();
            });
        }
        
        function openModal(id) {
            const cruise = cruiseData.find(c => c.id === id);
            if (!cruise) return;
            
            document.getElementById('modal-title').textContent = cruise.name;
            document.getElementById('modal-link').href = cruise.link;
            
            const body = document.getElementById('modal-body');
            body.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-bold text-lg mb-2">èˆªç¨‹è³‡è¨Š</h4>
                        <ul class="space-y-1.5 text-slate-700">
                            <li><strong>æ—¥æœŸ:</strong> ${cruise.date}</li>
                            <li><strong>å¤©æ•¸:</strong> ${cruise.duration} å¤©</li>
                            <li><strong>èˆ¹å:</strong> ${cruise.ship}</li>
                            <li><strong>è‰™æˆ¿:</strong> ${cruise.cabin}</li>
                            <li><strong>ç¸½åƒ¹:</strong> ${formatCurrency(cruise.price)} TWD</li>
                            <li><strong>è¨‚é‡‘:</strong> ${formatCurrency(cruise.deposit)} TWD</li>
                            <li><strong>äººå‡:</strong> ${formatCurrency(cruise.perPerson)} TWD</li>
                        </ul>
                    </div>
                     <div>
                        <h4 class="font-bold text-lg mb-2">æ¯æ—¥è¡Œç¨‹</h4>
                        <ul class="list-disc list-inside space-y-1.5 text-slate-700">
                           ${cruise.itinerary.map(item => `<li>${item}</li>`).join('')}
                        </ul>
                    </div>
                </div>
                <div class="mt-6">
                    <h4 class="font-bold text-lg mb-2">æ´»å‹•äº®é»</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-slate-100 p-4 rounded-lg">
                           <h5 class="font-semibold mb-2">åŸå»ºè­°äº®é»</h5>
                           <ul class="list-disc list-inside space-y-1 text-sm text-slate-600">
                                ${cruise.highlights.original.map(item => `<li>${item}</li>`).join('')}
                           </ul>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                           <h5 class="font-semibold mb-2 text-blue-800">2025 æµè¡Œè¶¨å‹¢</h5>
                           <ul class="list-disc list-inside space-y-1 text-sm text-blue-700">
                               ${cruise.highlights.trend.map(item => `<li>${item}</li>`).join('')}
                           </ul>
                        </div>
                    </div>
                </div>
            `;
            
            const modal = document.getElementById('modal');
            const modalContent = document.getElementById('modal-content');
            modal.classList.remove('opacity-0', 'pointer-events-none');
            modalContent.classList.remove('scale-95');
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            const modalContent = document.getElementById('modal-content');
            modal.classList.add('opacity-0');
            modalContent.classList.add('scale-95');
            setTimeout(() => {
                modal.classList.add('pointer-events-none');
            }, 250);
        }

        document.addEventListener('DOMContentLoaded', () => {
            applyFiltersAndSort();
            setupEventListeners();
        });
    </script>
</body>
</html>
